{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/common/ci.utils.js","webpack:///./src/blur-hash/index.js","webpack:///./src/blur-hash/ci.service.js","webpack:///./src/blur-hash/ci.utils.js","webpack:///./src/blur-hash/blurHash/index.js","webpack:///./src/blur-hash/blurHash/decode.js","webpack:///./src/blur-hash/blurHash/base83.js","webpack:///./src/blur-hash/blurHash/utils.js","webpack:///./src/blur-hash/blurHash/error.js","webpack:///./src/blur-hash/blurHash/imageDataPolyfill.js","webpack:///./node_modules/throttle-debounce/dist/index.esm.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","checkIfRelativeUrlPath","src","indexOf","window","location","protocol","extractBaseURLFromString","pathArray","arguments","length","undefined","split","relativeToAbsolutePath","base","relative","isRoot","stack","origin","document","baseURI","getBaseURL","parts","pop","shift","push","join","updateSizeWithPixelRatio","size","splittedSizes","toString","result","forEach","Math","floor","devicePixelRatio","toFixed","generateUrl","props","params","config","width","height","token","domain","doNotReplaceURL","includes","getQueryString","getPreviewSRC","_ref","previewQualityFactor","previewParams","ci_info","lowQualitySize","getLowQualitySize","_props$params","_getParamsExceptSizeR","getParamsExceptSizeRelated","_getParamsExceptSizeR2","_slicedToArray","restParams","_getParamsExceptSizeR3","widthFromParam","heightFromParam","widthQ","heightQ","restParamsQ","keys","map","encodeURIComponent","w","h","_objectWithoutProperties","factor","getAdaptiveSize","sizes","presets","resultSizes","media","normalizeSize","_params$w","_params$h","_params$r","percent","parseFloat","innerWidth","innerHeight","getSizeLimit","exactSize","ceil","getCommonImageProps","image","getSize","attr","getParams","imageNodeRatio","blurHash","isLazyCanceled","preserveSize","imageNodeWidth","imageNodeHeight","resultParams","temp","replace","matchedStr","substring","JSON","parse","e","decodeURI","getURLWithoutQueryParams","url","getParamsFromURL","queryIndex","slice","element","attribute","getAttribute","addClass","isOldBrowsers","isBlurHash","support","ImageData","Uint8ClampedArray","Element","elem","className","removeClass","RegExp","isImageSVG","toLowerCase","getRatio","determineContainerProps","imgNode","getWidth","getHeight","ratio","_ref2","_props$imgNode","_props$exactSize","_props$imageNodeWidth","_props$params2","_props$config","crop","isCrop","func","sizeParamsWidth","paramsWidth","imageNodeWidthPX","convertToPX","imageContainerWidth","getImageContainerWidth","_props$imgNode2","_props$config2","_props$exactSize2","_props$imageNodeHeigh","_props$params3","sizeParamsHeight","paramsRatio","paramsHeight","imageNodeHeightPX","imageContainerHeight","getImageContainerHeight","img","imageStyleHeight","style","imageHeight","parseInt","getParentContainerSize","imageStyleWidth","imageWidth","type","parentNode","getBoundingClientRect","leftPadding","getComputedStyle","paddingLeft","rightPadding","paddingRight","isApplyLowQualityPreview","isAdaptive","isSVG","setSrc","propertyName","lazy","imgSrc","dataSrcAttr","setAttribute","setBackgroundSrc","resultLink","backgroundImage","getImgSrc","baseURL","isRelativeURLPath","getBreakPoint","concat","_toConsumableArray","reverse","find","item","matchMedia","matches","filterImages","images","filtered","getImageProps","alignment","imageNodeSRC","_extends","getBackgroundImageProps","getInitialConfigLowPreview","_config$token","_config$domain","_config$lazyLoading","lazyLoading","_config$imgLoadingAni","imgLoadingAnimation","_config$width","_config$height","_config$placeholderBa","placeholderBackground","baseUrl","_config$params","_config$init","init","_config$exactSize","_config$doNotReplaceU","xs","sm","md","lg","xl","getInitialConfigBlurHash","_config$token3","_config$domain3","_config$lazyLoading3","_config$placeholderBa2","_config$params3","_config$init3","_config$exactSize3","_config$doNotReplaceU3","getInitialConfigPlain","_config$token2","_config$domain2","_config$lazyLoading2","_config$width2","_config$height2","_config$params2","_config$init2","_config$exactSize2","_config$doNotReplaceU2","finishAnimation","isBackground","canvas","opacity","setTimeout","removeProperty","filter","transform","getWrapper","setWrapperAlignment","wrapper","margin","isLazy","isUpdate","_ci","CIResponsive","_ci2","_throttleDebounce","_classCallCheck","this","_initialiseProps","addEventListener","loadBackgroundImage","debounce","onUpdateDimensions","process","_this","backgroundImages","windowScreenBecomesBigger","querySelectorAll","getBasicInfo","containerProps","imgProps","cloudimageUrl","applyOrUpdateWrapper","initImageClasses","initImageStyles","applyOrUpdateBlurHashCanvas","onload","onImageLoad","initImageBackgroundClasses","initImageBackgroundStyles","tempImage","Image","isImage","_this2","_getImgSrc","_getImgSrc2","processImage","processBackgroundImage","_blurHash","wrapImage","event","bgContainer","target","bg","ciBlurHash","optimizedImage","bgCanvas","querySelector","removeAttribute","paddingBottom","createElement","background","display","overflow","position","nextSibling","insertBefore","appendChild","padding","top","left","transition","pixels","decode","ctx","getContext","imageData","getImageData","data","set","putImageData","bottom","right","zIndex","prepend","default","isBlurhashValid","_base","_utils","_error","validateBlurhash","blurhash","ValidationError","sizeFlag","decode83","numY","numX","decodeDC","error","errorReason","message","intR","intG","intB","sRGBToLinear","decodeAC","maximumValue","quantR","quantG","quantB","signPow","punch","colors","Array","bytesPerRow","y","x","g","b","j","basis","cos","PI","color","linearTosRGB","digitCharacters","str","encode83","digit","pow","v","max","min","round","sign","val","exp","abs","_possibleConstructorReturn","__proto__","getPrototypeOf","Error","CanvasPixelArray","arr","args","TypeError","createImageData","throttle","delay","noTrailing","callback","debounceMode","timeoutID","cancelled","lastExec","clearExistingTimeout","clearTimeout","self","elapsed","Date","now","exec","apply","cancel","atBegin","__webpack_exports__"],"mappings":"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","file":"js-cloudimage-responsive.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","const checkIfRelativeUrlPath = src => {\n  if (!src) return false;\n\n  if (src.indexOf('//') === 0) {\n    src = window.location.protocol + src;\n  }\n\n  return (src.indexOf('http://') !== 0 && src.indexOf('https://') !== 0 && src.indexOf('//') !== 0);\n};\n\nconst getImgSrc = (src, baseURL = '') => {\n  const isRelativeURLPath = checkIfRelativeUrlPath(src);\n\n  if (src.indexOf('//') === 0) {\n    src = window.location.protocol + src;\n  }\n\n  if (isRelativeURLPath) {\n    src = relativeToAbsolutePath(baseURL, src);\n  }\n\n  return [src, isImageSVG(src)];\n};\n\nconst getBaseURL = (isRoot, base) => {\n  if (isRoot) {\n    return (base ? extractBaseURLFromString(base) : window.location.origin) + '/';\n  } else {\n    return base ? base : document.baseURI;\n  }\n}\n\nconst extractBaseURLFromString = (path = '') => {\n  const pathArray = path.split('/');\n  const protocol = pathArray[0];\n  const host = pathArray[2];\n\n  return protocol + '//' + host;\n}\n\nconst relativeToAbsolutePath = (base, relative) => {\n  const isRoot = relative[0] === '/';\n  const resultBaseURL = getBaseURL(isRoot, base);\n  const stack = resultBaseURL.split(\"/\");\n  const parts = relative.split(\"/\");\n\n  stack.pop(); // remove current file name (or empty string)\n               // (omit if \"base\" is the current folder without trailing slash)\n  if (isRoot) {\n    parts.shift();\n  }\n\n  for (let i = 0; i < parts.length; i++) {\n    if (parts[i] === \".\")\n      continue;\n    if (parts[i] === \"..\")\n      stack.pop();\n    else\n      stack.push(parts[i]);\n  }\n\n  return stack.join(\"/\");\n}\n\n/*\n* possible size values: 200 | 200x400\n* */\nexport const updateSizeWithPixelRatio = (size) => {\n  const splittedSizes = size.toString().split('x');\n  const result = [];\n\n  [].forEach.call(splittedSizes, size => {\n    size ? result.push(Math.floor(size * (window.devicePixelRatio.toFixed(1) || 1))) : '';\n  });\n\n  return result.join('x');\n};\n\nconst generateUrl = props => {\n  const { src, params, config, width, height } = props;\n  const { token, domain, doNotReplaceURL } = config;\n\n  return [\n    doNotReplaceURL ? '' : `https://${token}.${domain}/v7/`,\n    src,\n    src.includes('?') ? '&' : '?',\n    getQueryString({ params: { ...config.params, ...params }, width, height })\n  ].join('');\n};\n\nexport const getPreviewSRC = ({ config, width, height, params, src }) => {\n  const { previewQualityFactor } = config;\n  const previewParams = { ...params, ci_info: '' };\n  const lowQualitySize = getLowQualitySize({ width, height }, previewQualityFactor);\n\n  return generateUrl({ src, config, params: { ...previewParams, ...lowQualitySize } });\n};\n\nconst getQueryString = props => {\n  const {\n    params = {},\n    width,\n    height\n  } = props;\n  const [restParams, widthFromParam = null, heightFromParam] = getParamsExceptSizeRelated(params);\n  const widthQ = width ? updateSizeWithPixelRatio(width) : widthFromParam;\n  const heightQ = height ? updateSizeWithPixelRatio(height) : heightFromParam;\n  const restParamsQ = Object\n    .keys(restParams)\n    .map((key) => encodeURIComponent(key) + \"=\" + encodeURIComponent(restParams[key]))\n    .join('&');\n\n  return [\n    widthQ ? `w=${widthQ}` : '',\n    heightQ ? ((widthQ ? '&' : '') + `h=${heightQ}`) : '',\n    restParamsQ ? '&' + restParamsQ : ''\n  ].join('');\n};\n\nconst getParamsExceptSizeRelated = params => {\n  const { w, h, width, height, ...restParams } = params;\n\n  return [restParams, w || width, h || height];\n};\n\nconst getLowQualitySize = (params = {}, factor) => {\n  let { width, height } = params;\n\n  width = width ? Math.floor(width / factor) : null;\n  height = height ? Math.floor(height / factor) : null;\n\n  return { width, w: width, height, h: height };\n};\n\nconst getAdaptiveSize = (sizes, presets) => {\n  const resultSizes = [];\n\n  Object.keys(sizes).forEach(key => {\n    const isCustomMedia = key.indexOf(':') > -1;\n    const media = isCustomMedia ? key : presets[key];\n\n    resultSizes.push({ media, params: normalizeSize(sizes[key]) });\n  });\n\n  return resultSizes;\n};\n\nconst normalizeSize = (params = {}) => {\n  let { w = params.width || '', h = params.height || '', r = params.r } = params;\n\n  if ((w.toString()).indexOf('vw') > -1) {\n    const percent = parseFloat(w);\n\n    w = window.innerWidth * percent / 100;\n  } else {\n    w = parseFloat(w);\n  }\n\n  if ((h.toString()).indexOf('vh') > -1) {\n    const percent = parseFloat(h);\n\n    h = window.innerHeight * percent / 100;\n  } else {\n    h = parseFloat(h);\n  }\n\n  return { w, h, r };\n}\n\nconst getBreakPoint = (sizes, presets) => {\n  const size = getAdaptiveSize(sizes, presets);\n\n  return [...size].reverse().find(item => window.matchMedia(item.media).matches);\n}\n\nexport const getSizeLimit = (size, exactSize) => {\n  if (exactSize) return Math.ceil(size);\n  if (size <= 25) return 25;\n  if (size <= 50) return 50;\n\n  return Math.ceil(size / 100) * 100;\n};\n\nconst filterImages = (images, type) => {\n  const filtered = [];\n\n  for (let i = 0; i < images.length; i++) {\n    const image = images[i];\n    const isProcessed = image.className.includes(type);\n\n    if (!isProcessed) {\n      filtered.push(image);\n    }\n  }\n\n  return filtered;\n};\n\nconst getCommonImageProps = (image) => ({\n  sizes: getSize(attr(image, 'ci-sizes') || attr(image, 'data-ci-size') || {}) || undefined,\n  params: getParams(attr(image, 'ci-params') || attr(image, 'data-ci-params') || {}),\n  imageNodeRatio: attr(image, 'ci-ratio') || attr(image, 'data-ci-ratio') || undefined,\n  blurHash: attr(image, 'ci-blur-hash') || attr(image, 'data-ci-blur-hash') || undefined,\n  isLazyCanceled: (attr(image, 'ci-not-lazy') !== null || attr(image, 'data-ci-not-lazy') !== null) || undefined,\n  preserveSize: (attr(image, 'ci-preserve-size') !== null || attr(image, 'data-preserve-size') !== null) || undefined,\n  imageNodeWidth: attr(image, 'width'),\n  imageNodeHeight: attr(image, 'height')\n});\n\nconst getParams = (params) => {\n  let resultParams = undefined;\n\n  try {\n    let temp = params.replace(/(\\w+:)|(\\w+ :)/g, function (matchedStr) {\n      return '\"' + matchedStr.substring(0, matchedStr.length - 1) + '\":';\n    });\n\n    resultParams = JSON.parse(temp);\n  } catch (e) {}\n\n  if (!resultParams) {\n    try {\n      resultParams = JSON.parse('{\"' + decodeURI(params.replace(/&/g, \"\\\",\\\"\").replace(/=/g, \"\\\":\\\"\")) + '\"}');\n    } catch (e) {}\n  }\n\n  return resultParams;\n}\n\nconst getSize = (sizes) => {\n  let resultSizes = null;\n\n  try {\n    // add quotes around params\n    let temp = sizes.replace(/(\\w+:)|(\\w+ :)/g, function (matchedStr) {\n      return '\"' + matchedStr.substring(0, matchedStr.length - 1) + '\":';\n    });\n    // change single quotes to double quotes\n    temp = temp.replace(/'/g, '\"').replace(/-\"width\":/g, '-width:');\n    resultSizes = JSON.parse(temp);\n  } catch (e) {}\n\n  if (resultSizes) {\n    Object.keys(resultSizes).forEach(key => {\n      if (typeof resultSizes[key] === 'string') {\n        try {\n          resultSizes[key] = JSON.parse('{\"' + decodeURI(resultSizes[key].replace(/&/g, \"\\\",\\\"\").replace(/=/g, \"\\\":\\\"\")) + '\"}');\n        } catch (e) {}\n      }\n    });\n  }\n\n  return resultSizes;\n}\n\nconst getImageProps = (image) => {\n  const props = {\n    ...getCommonImageProps(image),\n    alignment: attr(image, 'ci-align') || attr(image, 'data-ci-align') || 'auto',\n    imageNodeSRC: attr(image, 'ci-src') || attr(image, 'data-ci-src') || undefined\n  };\n  const params = {\n    ...getParamsFromURL(props.imageNodeSRC),\n    ...props.params\n  };\n\n  return {\n    ...props,\n    params,\n    isAdaptive: !!props.sizes,\n    imageNodeSRC: getURLWithoutQueryParams(props.imageNodeSRC)\n  };\n};\n\nconst getBackgroundImageProps = (image) => {\n  const props = {\n    ...getCommonImageProps(image),\n    imageNodeSRC: attr(image, 'ci-bg-url') || attr(image, 'data-ci-bg-url') || undefined\n  };\n  const params = {\n    ...getParamsFromURL(props.imageNodeSRC),\n    ...props.params\n  };\n\n  return {\n    ...props,\n    params,\n    isAdaptive: !!props.sizes,\n    imageNodeSRC: getURLWithoutQueryParams(props.imageNodeSRC)\n  };\n};\n\nconst getURLWithoutQueryParams = url => url.split('?')[0];\n\nconst getParamsFromURL = (url) => {\n  const queryIndex = url.indexOf('?');\n\n  if (queryIndex === -1) return;\n\n  return getParams(url.slice(queryIndex + 1));\n};\n\nconst attr = (element, attribute) => element.getAttribute(attribute);\n\nexport const isOldBrowsers = (isBlurHash) => {\n  let support = true;\n\n  if (isBlurHash) {\n    try {\n      new window.ImageData(new Uint8ClampedArray([0, 0, 0, 0]), 1, 1);\n    } catch (e) {\n      support = false\n    }\n  }\n\n  return Element.prototype.hasOwnProperty('prepend') && support;\n};\n\nconst addClass = (elem, className) => {\n  if (!(elem.className.indexOf(className) > -1)) {\n    elem.className += ' ' + className;\n  }\n};\n\nconst removeClass = (elem, className) => {\n  if (elem.className.indexOf(className) > -1) {\n    elem.className = elem.className.replace(new RegExp('\\\\b' + className + '\\\\b', 'g'), '');\n  }\n};\n\nconst getInitialConfigLowPreview = (config) => {\n  const {\n    token = '',\n    domain = 'cloudimg.io',\n    lazyLoading = false,\n    imgLoadingAnimation = true,\n    width = '400',\n    height = '300',\n    placeholderBackground = '#f4f4f4',\n    baseUrl, // to support old name\n    baseURL,\n    ratio,\n    presets,\n    params = 'org_if_sml=1',\n    init = true,\n    exactSize = false,\n    doNotReplaceURL = false\n  } = config;\n\n  return {\n    token,\n    domain,\n    lazyLoading,\n    imgLoadingAnimation,\n    width,\n    height,\n    placeholderBackground,\n    baseURL: baseUrl || baseURL,\n    ratio,\n    exactSize,\n    presets: presets ? presets :\n      {\n        xs: '(max-width: 575px)',  // to 575       PHONE\n        sm: '(min-width: 576px)',  // 576 - 767    PHABLET\n        md: '(min-width: 768px)',  // 768 - 991    TABLET\n        lg: '(min-width: 992px)',  // 992 - 1199   SMALL_LAPTOP_SCREEN\n        xl: '(min-width: 1200px)'  // from 1200    USUALSCREEN\n      },\n    params: getParams(params),\n    innerWidth: window.innerWidth,\n    init,\n    previewQualityFactor: 10,\n    doNotReplaceURL\n    //isChrome: /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor)\n  };\n};\n\nconst getInitialConfigPlain = (config) => {\n  const {\n    token = '',\n    domain = 'cloudimg.io',\n    lazyLoading = false,\n    width = '400',\n    height = '300',\n    baseUrl, // to support old name\n    baseURL,\n    presets,\n    params = 'org_if_sml=1',\n    init = true,\n    exactSize = false,\n    doNotReplaceURL = false\n  } = config;\n\n  return {\n    token,\n    domain,\n    lazyLoading,\n    width,\n    height,\n    baseURL: baseUrl || baseURL,\n    exactSize,\n    presets: presets ? presets :\n      {\n        xs: '(max-width: 575px)',  // to 575       PHONE\n        sm: '(min-width: 576px)',  // 576 - 767    PHABLET\n        md: '(min-width: 768px)',  // 768 - 991    TABLET\n        lg: '(min-width: 992px)',  // 992 - 1199   SMALL_LAPTOP_SCREEN\n        xl: '(min-width: 1200px)'  // from 1200    USUALSCREEN\n      },\n    params: getParams(params),\n    innerWidth: window.innerWidth,\n    init,\n    doNotReplaceURL\n    //isChrome: /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor)\n  };\n};\n\nconst getInitialConfigBlurHash = (config) => {\n  const {\n    token = '',\n    domain = 'cloudimg.io',\n    lazyLoading = false,\n    placeholderBackground = '#f4f4f4',\n    baseUrl,\n    baseURL,\n    presets,\n    ratio,\n    params = 'org_if_sml=1',\n    init = true,\n    exactSize = false,\n    doNotReplaceURL = false\n  } = config;\n\n  return {\n    token,\n    domain,\n    lazyLoading,\n    placeholderBackground,\n    baseURL: baseUrl || baseURL,\n    ratio,\n    exactSize,\n    presets: presets ? presets :\n      {\n        xs: '(max-width: 575px)',  // to 575       PHONE\n        sm: '(min-width: 576px)',  // 576 - 767    PHABLET\n        md: '(min-width: 768px)',  // 768 - 991    TABLET\n        lg: '(min-width: 992px)',  // 992 - 1199   SMALL_LAPTOP_SCREEN\n        xl: '(min-width: 1200px)'  // from 1200    USUALSCREEN\n      },\n    params: getParams(params),\n    innerWidth: window.innerWidth,\n    init,\n    previewQualityFactor: 10,\n    doNotReplaceURL\n  };\n};\n\nconst finishAnimation = (image, isBackground, canvas) => {\n  if (canvas) {\n    if (isBackground) {\n      canvas.style.opacity = '0';\n    } else {\n      canvas.style.opacity = '0';\n      image.style.opacity = '1';\n    }\n  } else if (!isBackground) {\n    image.style.filter = 'blur(0px)';\n    image.style.transform = 'translateZ(0) scale(1)';\n  } else {\n    removeClass(image, 'ci-bg-animation');\n\n    setTimeout(() => {\n      image.style.removeProperty('overflow');\n    }, 300)\n  }\n\n  addClass(image, 'ci-image-loaded');\n};\n\nconst getWrapper = (image) => {\n  if ((image.parentNode.className || '').indexOf('ci-image-wrapper') > -1) {\n    return image.parentNode;\n  } else if ((image.parentNode.parentNode.className || '').indexOf('ci-image-wrapper') > -1) {\n    return image.parentNode.parentNode;\n  }\n};\n\nconst setWrapperAlignment = (wrapper, alignment) => {\n  switch (alignment) {\n    case 'auto':\n      break;\n    case 'center':\n      wrapper.style.margin = 'auto';\n  }\n}\n\nconst isImageSVG = url => url.slice(-4).toLowerCase() === '.svg';\n\nexport const determineContainerProps = props => {\n  const { imgNode, config, imageNodeWidth, imageNodeHeight, imageNodeRatio, params, size } = props;\n  const { exactSize } = config;\n  let width = getWidth({ imgNode, config, exactSize, imageNodeWidth, params: { ...config.params, ...params }, size });\n  let height = getHeight({ imgNode, config, exactSize, imageNodeHeight, params: { ...config.params, ...params }, size, width });\n  let ratio = getRatio({ imageNodeRatio, width, height, size });\n\n  if (!height && width && ratio) {\n    height = Math.floor(width / ratio);\n  }\n\n  if (!width && height && ratio) {\n    width = Math.floor(height * ratio);\n  }\n\n  return { width, height, ratio };\n}\n\nexport const getRatio = ({ imageNodeRatio, width, height, size }) => {\n  if (size && size.params) {\n    if (size.params.ratio) {\n      return size.params.ratio\n    } else if ((size.params.w || size.params.width) && (size.params.h || size.params.height)) {\n      return (size.params.w || size.params.width) / (size.params.h || size.params.height);\n    } else {\n      return null\n    }\n  }\n\n  if (imageNodeRatio) {\n    return imageNodeRatio;\n  } else if (width && height) {\n    return width / height;\n  }\n\n  return null;\n}\n\n/**\n * Get width for an image.\n *\n * Priority:\n * 1. image node param width\n * 2. image node image width\n * 3. image node inline styling\n * 4. parent node of image computed style width (up to body tag)\n *\n * @param {HTMLImageElement} props.imgNode - image node\n * @param {Boolean} props.exactSize - a flag to use exact width/height params\n * @param {Number} props.imageNodeWidth - width of image node\n * @param {String} props.params - params of image node\n * @return {Number} width limit\n */\nexport const getWidth = props => {\n  const {\n    imgNode = null,\n    exactSize = false,\n    imageNodeWidth = null,\n    params = {},\n    size,\n    config = {}\n  } = props;\n  const crop = isCrop(params.func || config.params.func);\n  const sizeParamsWidth = size && size.params && (size.params.w || size.params.width);\n  const paramsWidth = params.width || params.w;\n  const imageNodeWidthPX = imageNodeWidth && convertToPX(imageNodeWidth);\n  const imageContainerWidth = getImageContainerWidth(imgNode);\n  const result = crop ? imageContainerWidth : getSizeLimit(imageContainerWidth, exactSize);\n\n  if (size && size.params) {\n    if (size.params.r) {\n      if (params.width || params.w) {\n        return paramsWidth;\n      }\n\n      if (imageNodeWidth) {\n        return imageNodeWidthPX;\n      }\n\n      return result\n    }\n\n    return sizeParamsWidth;\n  }\n\n  if (paramsWidth) {\n    return paramsWidth;\n  }\n\n  if (imageNodeWidth) {\n    return imageNodeWidthPX;\n  }\n\n  return result;\n}\n\n/**\n * Get height for an image.\n *\n * Priority:\n * 1. image node param height\n * 2. image node image height\n * 3. image node inline styling\n * 4. parent node of image computed style height (up to body tag)\n *\n * @param {HTMLImageElement} props.imgNode - image node\n * @param {Object} props.config - plugin config\n * @param {Boolean} props.exactSize - a flag to use exact width/height params\n * @param {Number} props.imageNodeHeight - height of image node\n * @param {String} props.params - params of image node\n * @return {Number} height limit\n */\nexport const getHeight = props => {\n  const {\n    imgNode = null,\n    config = {},\n    exactSize = false,\n    imageNodeHeight = null,\n    params = {},\n    size,\n    width\n  } = props;\n  const crop = isCrop(params.func || config.params.func);\n  const sizeParamsHeight = size && size.params && (size.params.h || size.params.height);\n  const paramsRatio = size && size.params && (size.params.ratio || size.params.r);\n  const paramsHeight = params.height || params.h;\n  const imageNodeHeightPX = imageNodeHeight && convertToPX(imageNodeHeight);\n  const imageContainerHeight = getImageContainerHeight(imgNode);\n  const result = crop ? imageContainerHeight : getSizeLimit(imageContainerHeight, exactSize);\n\n  if (size && size.params) {\n    if (paramsRatio && width) {\n      return width / paramsRatio;\n    }\n\n    return sizeParamsHeight;\n  }\n\n  if (paramsHeight) {\n    return paramsHeight;\n  }\n\n  if (imageNodeHeight) {\n    return imageNodeHeightPX;\n  }\n\n  if (!crop) {\n    return null;\n  }\n\n  return result;\n};\n\n/**\n * Get container height for an image.\n *\n * Priority:\n * 1. inline styling\n * 2. parent node computed style width (up to body tag)\n *\n * @param {HTMLImageElement} img - image node\n * @return {Number} width of image container\n */\nexport const getImageContainerHeight = (img) => {\n  const imageStyleHeight = img && img.style && img.style.height;\n  const imageHeight = convertToPX(imageStyleHeight);\n\n  if (imageHeight) return parseInt(imageHeight, 10);\n\n  return parseInt(getParentContainerSize(img, 'height'), 10);\n}\n\n/**\n * Get container width for an image.\n *\n * Priority:\n * 1. inline styling\n * 2. parent node computed style width (up to body tag)\n *\n * @param {HTMLImageElement} img - image node\n * @return {Number} width of image container\n */\nexport const getImageContainerWidth = (img) => {\n  const imageStyleWidth = img && img.style && img.style.width;\n  const imageWidth = imageStyleWidth && convertToPX(imageStyleWidth);\n\n  if (imageWidth) return parseInt(imageWidth, 10);\n\n  return parseInt(getParentContainerSize(img), 10);\n}\n\nexport const convertToPX = (size = '') => {\n  size = size.toString();\n\n  if (size.indexOf('px') > -1) {\n    return parseInt(size);\n  } else if (size.indexOf('%') > -1) {\n    // todo calculate container width * %\n  } else if (size.indexOf('vw') > -1) {\n    return window.innerWidth * parseInt(size) / 100;\n  } else if (size.indexOf('vh') > -1) {\n    return window.innerHeight * parseInt(size) / 100;\n  }\n\n  return parseInt(size) || null;\n}\n\nconst getParentContainerSize = (img, type = 'width') => {\n  let parentNode = null;\n  let size = 0;\n\n  do {\n    parentNode = (parentNode && parentNode.parentNode) || img.parentNode;\n    size = parentNode.getBoundingClientRect()[type];\n  } while (parentNode && !size)\n\n  const leftPadding = size && parentNode && parseInt(window.getComputedStyle(parentNode).paddingLeft);\n  const rightPadding = parseInt(window.getComputedStyle(parentNode).paddingRight)\n\n  return size + (size ? (-leftPadding - rightPadding) : 0);\n};\n\nconst isLazy = (lazyLoading, isLazyCanceled, isUpdate) => {\n  if ((isLazyCanceled && lazyLoading) || isUpdate) {\n    lazyLoading = false;\n  }\n\n  return lazyLoading;\n};\n\nexport const isApplyLowQualityPreview = (isAdaptive, width, isSVG) => isAdaptive ? width > 400 : width > 400 && !isSVG;\n\nexport const setSrc = (image, url, propertyName, lazy, imgSrc, isSVG, dataSrcAttr) => {\n  image.setAttribute(\n    lazy ? (propertyName ? propertyName : 'data-src') : (dataSrcAttr ? dataSrcAttr : 'src'),\n    isSVG ? imgSrc : url\n  );\n};\n\nexport const setBackgroundSrc = (image, url, lazy, imgSrc, isSVG, dataSrcAttr) => {\n  const resultLink = isSVG ? imgSrc : url;\n\n  if (lazy) {\n    image.setAttribute((dataSrcAttr ? dataSrcAttr : 'data-bg'), resultLink);\n  } else {\n    image.style.backgroundImage = `url('${resultLink}')`\n  }\n};\n\nexport const isCrop = func => ['crop', 'fit', 'bound', 'cover'].includes(func);\n\nexport {\n  checkIfRelativeUrlPath,\n  getImgSrc,\n  generateUrl,\n  getBreakPoint,\n  filterImages,\n  getImageProps,\n  getBackgroundImageProps,\n  addClass,\n  removeClass,\n  getAdaptiveSize,\n  getLowQualitySize,\n  getInitialConfigLowPreview,\n  getInitialConfigBlurHash,\n  getInitialConfigPlain,\n  finishAnimation,\n  getWrapper,\n  getParams,\n  setWrapperAlignment,\n  isImageSVG,\n  isLazy\n}","//import 'core-js/features/typed-array/uint8-clamped-array';\n//import './prepend.polyfill';\nimport CIResponsive from './ci.service';\n\nwindow.CIResponsive = CIResponsive;","import {\n  determineContainerProps,\n  filterImages,\n  generateUrl,\n  getBackgroundImageProps,\n  getBreakPoint,\n  getImageProps,\n  getImgSrc,\n  getInitialConfigBlurHash,\n  isLazy,\n  isOldBrowsers,\n  setBackgroundSrc,\n  setSrc\n} from '../common/ci.utils';\nimport {\n  applyOrUpdateBlurHashCanvas,\n  applyOrUpdateWrapper,\n  finishAnimation,\n  initImageBackgroundClasses,\n  initImageBackgroundStyles,\n  initImageClasses,\n  initImageStyles,\n  loadBackgroundImage,\n  onImageLoad\n} from './ci.utils';\nimport { debounce } from 'throttle-debounce';\n\n\nexport default class CIResponsive {\n  constructor(config) {\n    this.config = getInitialConfigBlurHash(config);\n\n    if (this.config.init) this.init();\n\n    this.innerWidth = window.innerWidth;\n  }\n\n  init() {\n    document.addEventListener('lazybeforeunveil', loadBackgroundImage);\n    window.addEventListener('resize', debounce(100, this.onUpdateDimensions.bind(this)));\n\n    this.process();\n  }\n\n  onUpdateDimensions() {\n    this.process(true);\n\n    if (this.innerWidth < window.innerWidth) {\n      this.innerWidth = window.innerWidth;\n    }\n  }\n\n  process(isUpdate) {\n    let images, backgroundImages;\n    const windowScreenBecomesBigger = this.innerWidth < window.innerWidth;\n\n    if (isUpdate) {\n      images = document.querySelectorAll('img[ci-src]');\n      backgroundImages = document.querySelectorAll('[ci-bg-url]');\n    } else {\n      images = filterImages(document.querySelectorAll('img[ci-src]'), 'ci-image');\n      backgroundImages = filterImages(document.querySelectorAll('[ci-bg-url]'), 'ci-bg');\n    }\n\n    if (images.length > -1) {\n      images.forEach(imgNode => {\n        this.getBasicInfo(imgNode, isUpdate, windowScreenBecomesBigger, 'image');\n      });\n    }\n\n    if (backgroundImages.length > -1) {\n      backgroundImages.forEach(imgNode => {\n        this.getBasicInfo(imgNode, isUpdate, windowScreenBecomesBigger, 'background');\n      });\n    }\n  }\n\n  getBasicInfo = (imgNode, isUpdate, windowScreenBecomesBigger, type) => {\n    const isImage = type === 'image';\n    const { config } = this;\n    const { baseURL, lazyLoading, presets } = config;\n    const imgProps = isImage ? getImageProps(imgNode) : getBackgroundImageProps(imgNode);\n    const { params, imageNodeSRC, blurHash, isLazyCanceled, sizes, isAdaptive, preserveSize } = imgProps;\n\n    if (!imageNodeSRC) return;\n\n    const [src, isSVG] = getImgSrc(imageNodeSRC, baseURL);\n    const lazy = isLazy(lazyLoading, isLazyCanceled, isUpdate);\n    let size;\n\n    if (!isOldBrowsers(true)) {\n      if (isImage) {\n        imgNode.src = src;\n      } else {\n        imgNode.style.backgroundImage = 'url(' + src + ')';\n      }\n\n      return;\n    }\n\n    if (isAdaptive) {\n      size = getBreakPoint(sizes, presets);\n    } else {\n      if (isUpdate && !windowScreenBecomesBigger) return;\n    }\n\n    const containerProps = determineContainerProps({ ...imgProps, imgNode, config, size });\n    const cloudimageUrl = generateUrl({ src, params, config, ...containerProps });\n    const props = { config, isUpdate, imgNode, containerProps, imgProps, lazy, blurHash, cloudimageUrl, isSVG, src, preserveSize };\n\n    if (isImage) {\n      this.processImage(props);\n    } else {\n      this.processBackgroundImage(props);\n    }\n  }\n\n  processImage(props) {\n    const { config, isUpdate, imgNode, containerProps, imgProps, lazy, blurHash, cloudimageUrl, isSVG, src, preserveSize } = props;\n    const { ratio } = containerProps;\n    const { placeholderBackground, dataSrcAttr } = config;\n    const wrapper = applyOrUpdateWrapper({ isUpdate, imgNode, ratio, placeholderBackground, ...imgProps });\n\n    if (!isUpdate) {\n      initImageClasses(imgNode, lazy);\n      initImageStyles(imgNode);\n\n      const canvas = applyOrUpdateBlurHashCanvas(wrapper, blurHash);\n\n      imgNode.onload = () => { onImageLoad({ wrapper, imgNode, canvas: blurHash && canvas, ratio, preserveSize }) };\n    }\n\n    setSrc(imgNode, cloudimageUrl, null, lazy, src, isSVG, dataSrcAttr);\n  }\n\n  processBackgroundImage(props) {\n    const { config, isUpdate, imgNode, lazy, blurHash, cloudimageUrl, isSVG, src } = props;\n    const { dataSrcAttr } = config;\n\n    if (!isUpdate) {\n      initImageBackgroundClasses(imgNode, lazy);\n      initImageBackgroundStyles(imgNode);\n\n      const canvas = applyOrUpdateBlurHashCanvas(imgNode, blurHash);\n\n      if (!lazy) {\n        let tempImage = new Image();\n\n        tempImage.src = cloudimageUrl;\n\n        tempImage.onload = () => {\n          finishAnimation(imgNode, blurHash && canvas);\n        };\n      }\n    }\n\n    setBackgroundSrc(imgNode, cloudimageUrl, lazy, src, isSVG, dataSrcAttr);\n  }\n}","import { addClass, getWrapper, setWrapperAlignment } from '../common/ci.utils'\nimport { decode } from './blurHash';\n\n\nexport const loadBackgroundImage = (event) => {\n  const bgContainer = event.target;\n  const bg = bgContainer.getAttribute('data-bg');\n  const ciBlurHash = bgContainer.getAttribute('ci-blur-hash');\n\n  if (bg) {\n    let optimizedImage = new Image();\n\n    optimizedImage.onload = () => {\n      const bgCanvas = bgContainer.querySelector('canvas');\n\n      finishAnimation(bgContainer, ciBlurHash && bgCanvas);\n      bgContainer.removeAttribute('data-bg');\n      bgContainer.removeAttribute('ci-preview');\n    }\n\n    optimizedImage.src = bg;\n\n    bgContainer.style.backgroundImage = 'url(' + bg + ')';\n  }\n};\n\nexport const applyOrUpdateWrapper = props => {\n  const { isUpdate, imgNode, ratio, imageNodeWidth, imageNodeHeight, alignment, preserveSize, placeholderBackground } = props;\n  let wrapper = null;\n\n  if (!isUpdate) {\n    wrapper = wrapImage({ imgNode, ratio, imageNodeWidth, imageNodeHeight, alignment, preserveSize, placeholderBackground });\n  } else {\n    wrapper = getWrapper(imgNode);\n\n    if (ratio) {\n      wrapper.style.paddingBottom = preserveSize ? 'none' : (100 / ratio) + '%';\n    }\n  }\n\n  return wrapper;\n}\n\nexport const wrapImage = (props) => {\n  const { imgNode, ratio, imageNodeWidth, imageNodeHeight, alignment, preserveSize, placeholderBackground } = props;\n  let { wrapper } = props;\n\n  wrapper = wrapper || document.createElement('div');\n\n  addClass(wrapper, 'ci-image-wrapper');\n  wrapper.style.background = placeholderBackground;\n  wrapper.style.display = 'block';\n  wrapper.style.width = preserveSize ? imageNodeWidth : '100%';\n  wrapper.style.height = preserveSize ? imageNodeHeight : 'auto';\n  wrapper.style.overflow = 'hidden';\n  wrapper.style.position = 'relative';\n\n  if (ratio) {\n    wrapper.style.paddingBottom = preserveSize ? 'none' : (100 / ratio) + '%';\n  }\n\n  if (imgNode.nextSibling) {\n    imgNode.parentNode.insertBefore(wrapper, imgNode.nextSibling);\n  } else {\n    imgNode.parentNode.appendChild(wrapper);\n  }\n\n  setWrapperAlignment(wrapper, alignment);\n\n  wrapper.appendChild(imgNode);\n\n  return wrapper;\n};\n\nexport const finishAnimation = (image, canvas) => {\n  if (canvas && canvas.style) {\n    canvas.style.opacity = '0';\n  }\n\n  addClass(image, 'ci-image-loaded');\n};\n\nexport const initImageBackgroundClasses = (image, lazy) => {\n  addClass(image, 'ci-bg');\n\n  if (lazy) {\n    addClass(image, 'lazyload');\n  }\n};\n\nexport const initImageBackgroundStyles = (image) => {\n  image.style.position = (!image.style.position || image.style.position === 'static') ?\n    'relative' : image.style.position;\n};\n\nexport const initImageClasses = (imgNode, lazy) => {\n  addClass(imgNode, 'ci-image');\n\n  if (lazy) {\n    addClass(imgNode, 'lazyload');\n  }\n};\n\nexport const initImageStyles = imgNode => {\n  imgNode.style.display = 'block';\n  imgNode.style.width = '100%';\n  imgNode.style.padding = '0';\n  imgNode.style.position = 'absolute';\n  imgNode.style.top = '0';\n  imgNode.style.left = '0';\n  imgNode.style.height = 'auto';\n  imgNode.style.transition = 'opacity 400ms ease 0ms';\n};\n\nexport const applyOrUpdateBlurHashCanvas = (wrapper, blurHash) => {\n  let canvas = wrapper.querySelector('canvas');\n\n  if (!canvas && blurHash) {\n    canvas = document.createElement(\"canvas\");\n\n    const pixels = decode(blurHash, 32, 32);\n    canvas.width = 32;\n    canvas.height = 32;\n    const ctx = canvas.getContext(\"2d\");\n    const imageData = ctx.getImageData(0, 0, 32, 32);\n    imageData.data.set(pixels);\n    ctx.putImageData(imageData, 0, 0);\n    canvas.style.width = '100%';\n    canvas.style.height = '100%';\n    canvas.style.position = 'absolute';\n    canvas.style.top = '0';\n    canvas.style.bottom = '0';\n    canvas.style.left = '0';\n    canvas.style.right = '0';\n    canvas.style.opacity = '1';\n    canvas.style.zIndex = '1';\n    canvas.style.transition = 'opacity 400ms ease 0ms';\n\n    wrapper.prepend(canvas);\n  }\n\n  return canvas;\n};\n\nexport const onImageLoad = ({ wrapper, imgNode, canvas, ratio, preserveSize }) => {\n  wrapper.style.background = 'transparent';\n\n  if (!ratio) {\n    wrapper.style.paddingBottom = preserveSize ? 'none' : (100 / ((imgNode.width / imgNode.height) || 1)) + '%';\n  }\n\n  finishAnimation(imgNode, canvas)\n};","import './imageDataPolyfill';\n\nexport { default as decode, isBlurhashValid } from \"./decode\";","import { decode83 } from \"./base83\";\nimport { sRGBToLinear, signPow, linearTosRGB } from \"./utils\";\nimport { ValidationError } from \"./error\";\n\n/**\n * Returns an error message if invalid or undefined if valid\n * @param blurhash\n */\nconst validateBlurhash = (blurhash) => {\n  if (!blurhash || blurhash.length < 6) {\n    throw new ValidationError(\n      \"The blurhash string must be at least 6 characters\"\n    );\n  }\n\n  const sizeFlag = decode83(blurhash[0]);\n  const numY = Math.floor(sizeFlag / 9) + 1;\n  const numX = (sizeFlag % 9) + 1;\n\n  if (blurhash.length !== 4 + 2 * numX * numY) {\n    throw new ValidationError(\n      `blurhash length mismatch: length is ${\n        blurhash.length\n        } but it should be ${4 + 2 * numX * numY}`\n    );\n  }\n};\n\nexport const isBlurhashValid = (blurhash) => {\n  try {\n    validateBlurhash(blurhash);\n  } catch (error) {\n    return { result: false, errorReason: error.message };\n  }\n\n  return { result: true };\n};\n\nconst decodeDC = (value) => {\n  const intR = value >> 16;\n  const intG = (value >> 8) & 255;\n  const intB = value & 255;\n  return [sRGBToLinear(intR), sRGBToLinear(intG), sRGBToLinear(intB)];\n};\n\nconst decodeAC = (value, maximumValue) => {\n  const quantR = Math.floor(value / (19 * 19));\n  const quantG = Math.floor(value / 19) % 19;\n  const quantB = value % 19;\n\n  const rgb = [\n    signPow((quantR - 9) / 9, 2.0) * maximumValue,\n    signPow((quantG - 9) / 9, 2.0) * maximumValue,\n    signPow((quantB - 9) / 9, 2.0) * maximumValue\n  ];\n\n  return rgb;\n};\n\nconst decode = (blurhash, width, height, punch) => {\n  validateBlurhash(blurhash);\n\n  punch = punch | 1;\n\n  const sizeFlag = decode83(blurhash[0]);\n  const numY = Math.floor(sizeFlag / 9) + 1;\n  const numX = (sizeFlag % 9) + 1;\n\n  const quantisedMaximumValue = decode83(blurhash[1]);\n  const maximumValue = (quantisedMaximumValue + 1) / 166;\n\n  const colors = new Array(numX * numY);\n\n  for (let i = 0; i < colors.length; i++) {\n    if (i === 0) {\n      const value = decode83(blurhash.substring(2, 6));\n      colors[i] = decodeDC(value);\n    } else {\n      const value = decode83(blurhash.substring(4 + i * 2, 6 + i * 2));\n      colors[i] = decodeAC(value, maximumValue * punch);\n    }\n  }\n\n  const bytesPerRow = width * 4;\n  const pixels = new Uint8ClampedArray(bytesPerRow * height);\n\n  for (let y = 0; y < height; y++) {\n    for (let x = 0; x < width; x++) {\n      let r = 0;\n      let g = 0;\n      let b = 0;\n\n      for (let j = 0; j < numY; j++) {\n        for (let i = 0; i < numX; i++) {\n          const basis =\n            Math.cos((Math.PI * x * i) / width) *\n            Math.cos((Math.PI * y * j) / height);\n          let color = colors[i + j * numX];\n          r += color[0] * basis;\n          g += color[1] * basis;\n          b += color[2] * basis;\n        }\n      }\n\n      let intR = linearTosRGB(r);\n      let intG = linearTosRGB(g);\n      let intB = linearTosRGB(b);\n\n      pixels[4 * x + 0 + y * bytesPerRow] = intR;\n      pixels[4 * x + 1 + y * bytesPerRow] = intG;\n      pixels[4 * x + 2 + y * bytesPerRow] = intB;\n      pixels[4 * x + 3 + y * bytesPerRow] = 255; // alpha\n    }\n  }\n  return pixels;\n};\n\nexport default decode;\n","const digitCharacters = [\n  \"0\",\n  \"1\",\n  \"2\",\n  \"3\",\n  \"4\",\n  \"5\",\n  \"6\",\n  \"7\",\n  \"8\",\n  \"9\",\n  \"A\",\n  \"B\",\n  \"C\",\n  \"D\",\n  \"E\",\n  \"F\",\n  \"G\",\n  \"H\",\n  \"I\",\n  \"J\",\n  \"K\",\n  \"L\",\n  \"M\",\n  \"N\",\n  \"O\",\n  \"P\",\n  \"Q\",\n  \"R\",\n  \"S\",\n  \"T\",\n  \"U\",\n  \"V\",\n  \"W\",\n  \"X\",\n  \"Y\",\n  \"Z\",\n  \"a\",\n  \"b\",\n  \"c\",\n  \"d\",\n  \"e\",\n  \"f\",\n  \"g\",\n  \"h\",\n  \"i\",\n  \"j\",\n  \"k\",\n  \"l\",\n  \"m\",\n  \"n\",\n  \"o\",\n  \"p\",\n  \"q\",\n  \"r\",\n  \"s\",\n  \"t\",\n  \"u\",\n  \"v\",\n  \"w\",\n  \"x\",\n  \"y\",\n  \"z\",\n  \"#\",\n  \"$\",\n  \"%\",\n  \"*\",\n  \"+\",\n  \",\",\n  \"-\",\n  \".\",\n  \":\",\n  \";\",\n  \"=\",\n  \"?\",\n  \"@\",\n  \"[\",\n  \"]\",\n  \"^\",\n  \"_\",\n  \"{\",\n  \"|\",\n  \"}\",\n  \"~\"\n];\n\nexport const decode83 = (str) => {\n  let value = 0;\n  for (let i = 0; i < str.length; i++) {\n    const c = str[i];\n    const digit = digitCharacters.indexOf(c);\n    value = value * 83 + digit;\n  }\n  return value;\n};\n\nexport const encode83 = (n, length) => {\n  var result = \"\";\n  for (let i = 1; i <= length; i++) {\n    let digit = (Math.floor(n) / Math.pow(83, length - i)) % 83;\n    result += digitCharacters[Math.floor(digit)];\n  }\n  return result;\n};\n","export const sRGBToLinear = (value) => {\n  let v = value / 255;\n  if (v <= 0.04045) {\n    return v / 12.92;\n  } else {\n    return Math.pow((v + 0.055) / 1.055, 2.4);\n  }\n};\n\nexport const linearTosRGB = (value) => {\n  let v = Math.max(0, Math.min(1, value));\n  if (v <= 0.0031308) {\n    return Math.round(v * 12.92 * 255 + 0.5);\n  } else {\n    return Math.round((1.055 * Math.pow(v, 1 / 2.4) - 0.055) * 255 + 0.5);\n  }\n};\n\nexport const sign = (n) => (n < 0 ? -1 : 1);\n\nexport const signPow = (val, exp) =>\n  sign(val) * Math.pow(Math.abs(val), exp);\n","export class ValidationError extends Error {\n  constructor(message) {\n    super(message);\n\n    this.name = \"ValidationError\";\n    this.message = message;\n  }\n}\n","if(window.CanvasPixelArray) {\n  CanvasPixelArray.prototype.set = function(arr) {\n    var l=this.length, i=0;\n\n    for(;i<l;i++) {\n      this[i] = arr[i];\n    }\n  };\n}\n(() => {\n  try {\n    new window.ImageData(new Uint8ClampedArray([0, 0, 0, 0]), 1, 1);\n  } catch (e) {\n    function ImageDataPolyfill () {\n      let args = [...arguments], data;\n\n      if (args.length < 2) {\n        throw new TypeError(`\n          Failed to construct 'ImageData': 2 arguments required, but only ${args.length} present.\n        `);\n      }\n\n      if (args.length > 2) {\n        data = args.shift();\n\n        if (!(data instanceof Uint8ClampedArray)) {\n          throw new TypeError(`\n            Failed to construct 'ImageData': parameter 1 is not of type 'Uint8ClampedArray'\n          `);\n        }\n\n        if (data.length !== 4 * args[0] * args[1]) {\n          throw new Error(`\n            Failed to construct 'ImageData': The input data byte length is not a multiple of (4 * width * height)\n          `);\n        }\n      }\n\n      const width = args[0],\n        height = args[1],\n        canvas = document.createElement('canvas'),\n        ctx = canvas.getContext('2d'),\n        imageData = ctx.createImageData(width, height);\n\n      if (data) imageData.data.set(data);\n      return imageData;\n    };\n\n    window.ImageData = ImageDataPolyfill;\n  }\n})();","/* eslint-disable no-undefined,no-param-reassign,no-shadow */\n\n/**\n * Throttle execution of a function. Especially useful for rate limiting\n * execution of handlers on events like resize and scroll.\n *\n * @param  {Number}    delay          A zero-or-greater delay in milliseconds. For event callbacks, values around 100 or 250 (or even higher) are most useful.\n * @param  {Boolean}   [noTrailing]   Optional, defaults to false. If noTrailing is true, callback will only execute every `delay` milliseconds while the\n *                                    throttled-function is being called. If noTrailing is false or unspecified, callback will be executed one final time\n *                                    after the last throttled-function call. (After the throttled-function has not been called for `delay` milliseconds,\n *                                    the internal counter is reset)\n * @param  {Function}  callback       A function to be executed after delay milliseconds. The `this` context and all arguments are passed through, as-is,\n *                                    to `callback` when the throttled-function is executed.\n * @param  {Boolean}   [debounceMode] If `debounceMode` is true (at begin), schedule `clear` to execute after `delay` ms. If `debounceMode` is false (at end),\n *                                    schedule `callback` to execute after `delay` ms.\n *\n * @return {Function}  A new, throttled, function.\n */\nfunction throttle (delay, noTrailing, callback, debounceMode) {\n  /*\n   * After wrapper has stopped being called, this timeout ensures that\n   * `callback` is executed at the proper times in `throttle` and `end`\n   * debounce modes.\n   */\n  var timeoutID;\n  var cancelled = false; // Keep track of the last time `callback` was executed.\n\n  var lastExec = 0; // Function to clear existing timeout\n\n  function clearExistingTimeout() {\n    if (timeoutID) {\n      clearTimeout(timeoutID);\n    }\n  } // Function to cancel next exec\n\n\n  function cancel() {\n    clearExistingTimeout();\n    cancelled = true;\n  } // `noTrailing` defaults to falsy.\n\n\n  if (typeof noTrailing !== 'boolean') {\n    debounceMode = callback;\n    callback = noTrailing;\n    noTrailing = undefined;\n  }\n  /*\n   * The `wrapper` function encapsulates all of the throttling / debouncing\n   * functionality and when executed will limit the rate at which `callback`\n   * is executed.\n   */\n\n\n  function wrapper() {\n    var self = this;\n    var elapsed = Date.now() - lastExec;\n    var args = arguments;\n\n    if (cancelled) {\n      return;\n    } // Execute `callback` and update the `lastExec` timestamp.\n\n\n    function exec() {\n      lastExec = Date.now();\n      callback.apply(self, args);\n    }\n    /*\n     * If `debounceMode` is true (at begin) this is used to clear the flag\n     * to allow future `callback` executions.\n     */\n\n\n    function clear() {\n      timeoutID = undefined;\n    }\n\n    if (debounceMode && !timeoutID) {\n      /*\n       * Since `wrapper` is being called for the first time and\n       * `debounceMode` is true (at begin), execute `callback`.\n       */\n      exec();\n    }\n\n    clearExistingTimeout();\n\n    if (debounceMode === undefined && elapsed > delay) {\n      /*\n       * In throttle mode, if `delay` time has been exceeded, execute\n       * `callback`.\n       */\n      exec();\n    } else if (noTrailing !== true) {\n      /*\n       * In trailing throttle mode, since `delay` time has not been\n       * exceeded, schedule `callback` to execute `delay` ms after most\n       * recent execution.\n       *\n       * If `debounceMode` is true (at begin), schedule `clear` to execute\n       * after `delay` ms.\n       *\n       * If `debounceMode` is false (at end), schedule `callback` to\n       * execute after `delay` ms.\n       */\n      timeoutID = setTimeout(debounceMode ? clear : exec, debounceMode === undefined ? delay - elapsed : delay);\n    }\n  }\n\n  wrapper.cancel = cancel; // Return the wrapper function.\n\n  return wrapper;\n}\n\n/* eslint-disable no-undefined */\n/**\n * Debounce execution of a function. Debouncing, unlike throttling,\n * guarantees that a function is only executed a single time, either at the\n * very beginning of a series of calls, or at the very end.\n *\n * @param  {Number}   delay         A zero-or-greater delay in milliseconds. For event callbacks, values around 100 or 250 (or even higher) are most useful.\n * @param  {Boolean}  [atBegin]     Optional, defaults to false. If atBegin is false or unspecified, callback will only be executed `delay` milliseconds\n *                                  after the last debounced-function call. If atBegin is true, callback will be executed only at the first debounced-function call.\n *                                  (After the throttled-function has not been called for `delay` milliseconds, the internal counter is reset).\n * @param  {Function} callback      A function to be executed after delay milliseconds. The `this` context and all arguments are passed through, as-is,\n *                                  to `callback` when the debounced-function is executed.\n *\n * @return {Function} A new, debounced function.\n */\n\nfunction debounce (delay, atBegin, callback) {\n  return callback === undefined ? throttle(delay, atBegin, false) : throttle(delay, callback, atBegin !== false);\n}\n\nexport { throttle, debounce };\n"],"sourceRoot":""}